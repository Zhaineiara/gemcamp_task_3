<div class="container-fluid mt-0">
  <div class="m-5">
    <table class="table table-bordered table-striped gap-2">
      <thead class="table-dark">
      <tr>
        <th scope="col" class="text-center">#</th>
        <th scope="col" class="text-center">Title</th>
        <th scope="col" class="text-center">Description</th>
        <th scope="col" class="text-center">Genres</th>
        <th scope="col" class="text-center">Date Released</th>
        <th scope="col" class="text-center">Country of Origin</th>
        <th scope="col" class="text-center">Showing Start</th>
        <th scope="col" class="text-center">Showing End</th>
        <th scope="col" class="text-center" style="width: 120px;">Actions</th>
      </tr>
      </thead>

      <tbody class="table-secondary">
      <% @movies.each_with_index do |movie, index| %>
        <tr>
          <td class="text-center"><%= index + 1 %></td>
          <td class="text-left"><%= link_to movie.title, movie_path(movie) %></td>
          <td class="text-left"><%= movie.description %></td>
          <td class="text-center">
            <% if movie.genres.any? %>
              <% movie.genres.each do |genre| %>
                <span class="badge bg-secondary"><%= genre.name %></span>
              <% end %>
            <% else %>
              -
            <% end %>
          </td>
          <td class="text-center"><%= movie.date_released.strftime('%B %d, %Y') if movie.date_released %></td>
          <td class="text-center"><%= movie.country_of_origin %></td>
          <td class="text-center"><%= movie.showing_start.strftime('%B %d, %Y') if movie.showing_start %></td>
          <td class="text-center"><%= movie.showing_end.strftime('%B %d, %Y') if movie.showing_end %></td>
          <td class="text-center">
            <%= link_to '<i class="bi bi-pencil-fill small-icon"></i>'.html_safe, edit_movie_path(movie), class: "btn btn-secondary", title: "Edit" %>
            <%= link_to '<i class="bi bi-trash-fill small-icon"></i>'.html_safe, movie_path(movie), class: "btn btn-danger", data: { bs_toggle: "modal", bs_target: "#deleteModal#{movie.id}" }, title: "Delete" %>

            <div class="modal fade" id="deleteModal<%= movie.id %>" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    Are you sure you want to delete this movie?
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <%= button_to '<i class="bi bi-trash-fill small-icon"></i>'.html_safe, movie_path(movie), method: :delete, class: "btn btn-danger", title: "Delete" %>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>
